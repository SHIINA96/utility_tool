# json2csv_simplify_ch.py — 详细说明

目的

将 JSON 转换为 CSV，并确保包含简体中文时在 Excel 中正确显示。脚本会在第一列添加序号，并把文本中的换行符替换为空格。

主要配置与行为

- 输入文件：脚本默认读取 `input.json`（位于脚本同目录），你可以在脚本底部修改 `json_file_path`。
- 输出文件：脚本默认写入 `output.csv`（UTF-8 BOM 编码，`utf-8-sig`）。
- 文本清理：脚本会把所有字符串类型字段中的换行符替换为空格（以防止 Excel 打开时换行导致的显示/格式问题）。
- 序号列：脚本会在 CSV 的最前面插入一列 `序号`，从 1 开始。

使用方法

1. 将要转换的 JSON 放到脚本目录，命名为 `input.json`，或修改脚本中的 `json_file_path` 指向你的文件。
2. 运行脚本：

```bash
python json2csv_simplify_ch.py
```

3. 打开 `output.csv`，Excel（Windows / macOS）应该能正确识别并显示中文。

示例输入（`examples/json/input.json`）

```json
[
  {"姓名": "张三", "年龄": 25, "城市": "北京", "描述": "这是一段\n包含换行的文本"},
  {"姓名": "李四", "年龄": 30, "城市": "上海", "描述": "单行文本"}
]
```

示例注意事项

- 输入 JSON 必须是有效的 JSON（对象数组或单个对象）。
- 若你的数据包含非常大的数目或非常深的嵌套对象，输出 CSV 会把字段名扁平化为顶层键（脚本目前按每个对象的直接键集合表头）。

常见问题

- Excel 打开仍乱码：请确保 Excel 打开 CSV 时使用 UTF-8 或直接用「导入/从文本」方式选择 UTF-8 编码；脚本默认写入 UTF-8 BOM，可大多数 Excel 版本自动识别。

扩展建议

- 若需更复杂的扁平化（嵌套对象、数组展开），可以把预处理函数 `clean_text` 前加入字段扁平化逻辑。
